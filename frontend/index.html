<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSINT Rehber | Ki≈üi ƒ∞stihbarat Sistemi</title>
    <meta name="description" content="A√ßƒ±k kaynak istihbarat rehber sistemi - Ki≈üi y√∂netimi ve analizi">

    <!-- Favicon -->
    <link rel="icon" type="image/jpeg" href="logo.jpg">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Leaflet MarkerCluster CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- ===== AUTH SCREENS ===== -->
    <div id="authScreen" class="auth-container">
        <!-- Login Form -->
        <div id="loginForm" class="auth-card">
            <div class="auth-header">
                <div class="logo">
                    <img src="logo.jpg" alt="OSINT Rehber Logo" class="logo-image">
                    <span class="logo-text">OSINT<span class="accent">Rehber</span></span>
                </div>
                <p class="auth-subtitle">Ki≈üi ƒ∞stihbarat Sistemi</p>
            </div>

            <form id="loginFormElement">
                <div class="form-group">
                    <label for="loginUsername">Kullanƒ±cƒ± Adƒ±</label>
                    <input type="text" id="loginUsername" placeholder="Kullanƒ±cƒ± adƒ±nƒ±z" required
                        autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="loginPassword">≈ûifre</label>
                    <input type="password" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
                        autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary btn-full">
                    <span>Giri≈ü Yap</span>
                    <span class="btn-icon">‚Üí</span>
                </button>
            </form>

            <div class="auth-footer">
                <span>Hesabƒ±nƒ±z yok mu?</span>
                <a href="#" id="showRegister">Kayƒ±t Ol</a>
            </div>
        </div>

        <!-- Register Form -->
        <div id="registerForm" class="auth-card" style="display: none;">
            <div class="auth-header">
                <div class="logo">
                    <img src="logo.jpg" alt="OSINT Rehber Logo" class="logo-image">
                    <span class="logo-text">OSINT<span class="accent">Rehber</span></span>
                </div>
                <p class="auth-subtitle">Yeni Hesap Olu≈ütur</p>
            </div>

            <form id="registerFormElement">
                <div class="form-group">
                    <label for="registerUsername">Kullanƒ±cƒ± Adƒ±</label>
                    <input type="text" id="registerUsername" placeholder="En az 3 karakter" required minlength="3">
                </div>
                <div class="form-group">
                    <label for="registerEmail">E-posta (Opsiyonel)</label>
                    <input type="email" id="registerEmail" placeholder="ornek@email.com">
                </div>
                <div class="form-group">
                    <label for="registerPassword">≈ûifre</label>
                    <input type="password" id="registerPassword" placeholder="En az 6 karakter" required minlength="6">
                </div>
                <button type="submit" class="btn btn-primary btn-full">
                    <span>Kayƒ±t Ol</span>
                    <span class="btn-icon">‚Üí</span>
                </button>
            </form>

            <div class="auth-footer">
                <span>Zaten hesabƒ±nƒ±z var mƒ±?</span>
                <a href="#" id="showLogin">Giri≈ü Yap</a>
            </div>
        </div>
    </div>

    <!-- ===== MAIN APP ===== -->
    <div id="mainApp" class="app-container" style="display: none;">
        <!-- Skip Link for Accessibility -->
        <a href="#mainContent" class="skip-link">ƒ∞√ßeriƒüe Atla</a>

        <!-- Mobile Menu Toggle -->
        <button id="menuToggle" class="menu-toggle" aria-label="Men√ºy√º A√ß/Kapat">
            <span class="menu-toggle-icon"></span>
        </button>

        <!-- Sidebar Overlay (Mobile) -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <img src="logo.jpg" alt="OSINT Rehber Logo" class="logo-image">
                    <span class="logo-text">OSINT<span class="accent">Rehber</span></span>
                </div>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-view="dashboard">
                    <span class="nav-icon">‚äû</span>
                    <span>Dashboard</span>
                </a>
                <a href="#" class="nav-item" data-view="contacts">
                    <span class="nav-icon">‚óé</span>
                    <span>Ki≈üiler</span>
                </a>
                <a href="#" class="nav-item" data-view="map">
                    <span class="nav-icon">‚óà</span>
                    <span>Harita</span>
                </a>
                <a href="#" class="nav-item" data-view="network">
                    <span class="nav-icon">‚¨°</span>
                    <span>Aƒü Grafiƒüi</span>
                </a>
                <a href="#" class="nav-item" data-view="osint">
                    <span class="nav-icon">üîç</span>
                    <span>OSINT Ara√ßlarƒ±</span>
                </a>
                <a href="#" class="nav-item" data-view="add">
                    <span class="nav-icon">‚äï</span>
                    <span>Ki≈üi Ekle</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="user-info">
                    <img src="logo.jpg" alt="User" class="user-avatar-img">
                    <span id="currentUsername">Kullanƒ±cƒ±</span>
                </div>
                <button id="logoutBtn" class="btn btn-ghost btn-sm">√áƒ±kƒ±≈ü</button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content" id="mainContent">
            <!-- Header -->
            <header class="main-header">
                <div class="header-left">
                    <h1 id="pageTitle">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <input type="text" id="globalSearch" placeholder="Ki≈üi ara... (Ctrl+K)" aria-label="Ki≈üi ara">
                        <span class="search-icon">‚åï</span>
                    </div>
                    <!-- Export/Import Dropdown -->
                    <div class="dropdown" id="exportDropdown">
                        <button class="btn btn-secondary dropdown-toggle" id="exportBtn">
                            üì• Dƒ±≈üa/ƒ∞√ße Aktar
                        </button>
                        <div class="dropdown-menu">
                            <div class="dropdown-section">
                                <span class="dropdown-label">Dƒ±≈üa Aktar</span>
                                <button class="dropdown-item" data-export="csv">üìä CSV</button>
                                <button class="dropdown-item" data-export="json">üìÑ JSON</button>
                                <button class="dropdown-item" data-export="vcard">üë§ vCard</button>
                                <button class="dropdown-item" data-export="report">üìë HTML Rapor</button>
                            </div>
                            <div class="dropdown-divider"></div>
                            <div class="dropdown-section">
                                <span class="dropdown-label">ƒ∞√ße Aktar</span>
                                <button class="dropdown-item" id="importFileBtn">üìÅ Dosya Y√ºkle</button>
                                <input type="file" id="importFileInput" accept=".csv,.json,.vcf,.vcard" hidden>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Views Container -->
            <div class="views-container">
                <!-- Dashboard View -->
                <div id="dashboardView" class="view active">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">‚óé</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statTotalContacts">0</span>
                                <span class="stat-label">Toplam Ki≈üi</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚òÖ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statFavorites">0</span>
                                <span class="stat-label">Favori</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚óà</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statWithLocation">0</span>
                                <span class="stat-label">Konumlu</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚úâ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="statWithEmail">0</span>
                                <span class="stat-label">E-postalƒ±</span>
                            </div>
                        </div>
                    </div>

                    <div class="dashboard-widgets">
                        <div class="widget">
                            <div class="widget-header">
                                <h3>Son Eklenen Ki≈üiler</h3>
                            </div>
                            <div class="widget-content" id="recentContacts">
                                <p class="empty-state">Hen√ºz ki≈üi eklenmemi≈ü</p>
                            </div>
                        </div>
                        <div class="widget">
                            <div class="widget-header">
                                <h3>Hƒ±zlƒ± Harita</h3>
                            </div>
                            <div class="widget-content">
                                <div id="miniMap" class="mini-map"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contacts View -->
                <div id="contactsView" class="view">
                    <div class="contacts-toolbar">
                        <div class="toolbar-left">
                            <select id="filterTag" class="select-input">
                                <option value="">T√ºm Etiketler</option>
                            </select>
                            <select id="sortBy" class="select-input">
                                <option value="isim">ƒ∞sme G√∂re</option>
                                <option value="created_at">Tarihe G√∂re</option>
                                <option value="eposta">E-postaya G√∂re</option>
                            </select>
                            <label class="checkbox-label">
                                <input type="checkbox" id="filterFavorites">
                                <span>Sadece Favoriler</span>
                            </label>
                        </div>
                        <div class="toolbar-right">
                            <button id="exportEmailsBtn" class="btn btn-secondary btn-sm">
                                ‚úâ E-postalarƒ± Dƒ±≈üa Aktar
                            </button>
                        </div>
                    </div>

                    <div id="contactsList" class="contacts-grid">
                        <p class="empty-state">Y√ºkleniyor...</p>
                    </div>

                    <div id="pagination" class="pagination"></div>
                </div>

                <!-- Map View -->
                <div id="mapView" class="view">
                    <!-- Map Controls -->
                    <div class="map-controls">
                        <div class="map-control-group">
                            <label>G√∂r√ºn√ºm:</label>
                            <div class="btn-group">
                                <button id="mapModeMarkers" class="btn btn-sm active" data-mode="markers">
                                    üìç ƒ∞≈üaret√ßiler
                                </button>
                                <button id="mapModeHeatmap" class="btn btn-sm" data-mode="heatmap">
                                    üî• Isƒ± Haritasƒ±
                                </button>
                                <button id="mapModeClusters" class="btn btn-sm" data-mode="clusters">
                                    üéØ K√ºmeleme
                                </button>
                            </div>
                        </div>
                        <div class="map-control-group">
                            <label>Yakƒ±nlƒ±k Aramasƒ±:</label>
                            <div class="proximity-controls">
                                <input type="number" id="proximityRadius" value="5" min="1" max="100" class="input-sm">
                                <span>km</span>
                                <button id="enableProximity" class="btn btn-sm btn-secondary">
                                    üéØ Haritaya Tƒ±kla
                                </button>
                            </div>
                        </div>
                        <div class="map-control-group">
                            <div id="mapStats" class="map-stats">
                                <span id="mapContactCount">0 ki≈üi</span>
                                <span id="mapClusterCount"></span>
                            </div>
                        </div>
                    </div>
                    <div id="fullMap" class="full-map"></div>
                    <!-- Proximity Results Panel -->
                    <div id="proximityPanel" class="proximity-panel" style="display: none;">
                        <div class="panel-header">
                            <h4>Yakƒ±ndaki Ki≈üiler</h4>
                            <button id="closeProximity" class="btn btn-ghost btn-sm">‚úï</button>
                        </div>
                        <div id="proximityResults"></div>
                    </div>
                </div>

                <!-- Network View (Phase 5) -->
                <div id="networkView" class="view">
                    <div class="network-controls">
                        <div class="network-control-group">
                            <button id="autoDetectBtn" class="btn btn-primary">
                                üîç Otomatik Tespit
                            </button>
                            <button id="addRelationshipBtn" class="btn btn-secondary">
                                ‚ûï ƒ∞li≈üki Ekle
                            </button>
                        </div>
                        <div class="network-stats" id="networkStats">
                            <span id="nodeCount">0 d√ºƒü√ºm</span>
                            <span id="edgeCount">0 baƒülantƒ±</span>
                        </div>
                    </div>
                    <div class="network-container">
                        <svg id="networkGraph"></svg>
                    </div>
                    <!-- Network Legend -->
                    <div class="network-legend">
                        <div class="legend-title">ƒ∞li≈üki Tipleri</div>
                        <div class="legend-items">
                            <div class="legend-item">
                                <span class="legend-color" style="background: #E91E63;"></span>
                                <span>Aile</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #2196F3;"></span>
                                <span>ƒ∞≈ü</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #4CAF50;"></span>
                                <span>Arkada≈ü</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #FF9800;"></span>
                                <span>Tanƒ±dƒ±k</span>
                            </div>
                            <div class="legend-item">
                                <span class="legend-color" style="background: #9E9E9E;"></span>
                                <span>Diƒüer</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- OSINT Tools View (Phase 6) -->
                <div id="osintView" class="view">
                    <div class="osint-container">
                        <!-- API Status -->
                        <div class="osint-status" id="osintApiStatus">
                            <span class="status-loading">API durumlarƒ± y√ºkleniyor...</span>
                        </div>

                        <!-- Tabs -->
                        <div class="osint-tabs">
                            <button class="osint-tab active" data-tab="breach">üîì ƒ∞hlal Kontrol√º</button>
                            <button class="osint-tab" data-tab="email">üìß E-posta Doƒürulama</button>
                            <button class="osint-tab" data-tab="ip">üåê IP Lookup</button>
                            <button class="osint-tab" data-tab="domain">üîç Domain Analizi</button>
                        </div>

                        <!-- Tab Content: Breach Check -->
                        <div class="osint-tab-content active" id="breachTab">
                            <div class="osint-form">
                                <h3>HaveIBeenPwned Kontrol√º</h3>
                                <p class="form-desc">E-posta adresinin veri ihlallerinde olup olmadƒ±ƒüƒ±nƒ± kontrol edin.
                                </p>
                                <div class="form-row">
                                    <input type="email" id="hibpEmail" placeholder="E-posta adresi" class="input-lg">
                                    <button type="button" id="checkHibpBtn" class="btn btn-primary">Kontrol Et</button>
                                </div>
                                <div class="osint-result" id="hibpResult"></div>
                            </div>
                            <hr>
                            <div class="osint-form">
                                <h3>≈ûifre Kontrol√º (k-Anonymity)</h3>
                                <p class="form-desc">≈ûifrenizin veri ihlallerinde g√∂r√ºl√ºp g√∂r√ºlmediƒüini g√ºvenli kontrol.
                                </p>
                                <div class="form-row">
                                    <input type="password" id="hibpPassword" placeholder="≈ûifre" class="input-lg">
                                    <button type="button" id="checkPasswordBtn" class="btn btn-secondary">Kontrol
                                        Et</button>
                                </div>
                                <div class="osint-result" id="passwordResult"></div>
                            </div>
                        </div>

                        <!-- Tab Content: Email Verification -->
                        <div class="osint-tab-content" id="emailTab">
                            <div class="osint-form">
                                <h3>Hunter.io E-posta Doƒürulama</h3>
                                <p class="form-desc">E-posta adresinin ger√ßek ve ula≈üƒ±labilir olup olmadƒ±ƒüƒ±nƒ±
                                    doƒürulayƒ±n.</p>
                                <div class="form-row">
                                    <input type="email" id="hunterEmail" placeholder="E-posta adresi" class="input-lg">
                                    <button type="button" id="verifyHunterBtn" class="btn btn-primary">Doƒürula</button>
                                </div>
                                <div class="osint-result" id="hunterResult"></div>
                            </div>
                            <hr>
                            <div class="osint-form">
                                <h3>Domain E-posta Aramasƒ±</h3>
                                <p class="form-desc">Bir domain'e ait e-posta adreslerini bulun.</p>
                                <div class="form-row">
                                    <input type="text" id="hunterDomain" placeholder="example.com" class="input-lg">
                                    <button type="button" id="searchDomainBtn" class="btn btn-secondary">Ara</button>
                                </div>
                                <div class="osint-result" id="domainSearchResult"></div>
                            </div>
                        </div>

                        <!-- Tab Content: IP Lookup -->
                        <div class="osint-tab-content" id="ipTab">
                            <div class="osint-form">
                                <h3>Shodan IP Lookup</h3>
                                <p class="form-desc">IP adresi hakkƒ±nda detaylƒ± bilgi alƒ±n (portlar, servisler, g√ºvenlik
                                    a√ßƒ±klarƒ±).</p>
                                <div class="form-row">
                                    <input type="text" id="shodanIp" placeholder="8.8.8.8" class="input-lg">
                                    <button type="button" id="lookupIpBtn" class="btn btn-primary">Ara</button>
                                </div>
                                <div class="osint-result" id="shodanResult"></div>
                            </div>
                        </div>

                        <!-- Tab Content: Domain Analysis -->
                        <div class="osint-tab-content" id="domainTab">
                            <div class="osint-form">
                                <h3>VirusTotal Domain Analizi</h3>
                                <p class="form-desc">Domain'in g√ºvenlik durumunu ve zararlƒ± i√ßerik i√ßerip i√ßermediƒüini
                                    kontrol edin.</p>
                                <div class="form-row">
                                    <input type="text" id="vtDomain" placeholder="example.com" class="input-lg">
                                    <button type="button" id="analyzeDomainBtn" class="btn btn-primary">Analiz
                                        Et</button>
                                </div>
                                <div class="osint-result" id="vtDomainResult"></div>
                            </div>
                            <hr>
                            <div class="osint-form">
                                <h3>VirusTotal URL Kontrol√º</h3>
                                <p class="form-desc">URL'nin zararlƒ± olup olmadƒ±ƒüƒ±nƒ± kontrol edin.</p>
                                <div class="form-row">
                                    <input type="url" id="vtUrl" placeholder="https://example.com/page"
                                        class="input-lg">
                                    <button type="button" id="analyzeUrlBtn" class="btn btn-secondary">Kontrol
                                        Et</button>
                                </div>
                                <div class="osint-result" id="vtUrlResult"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add/Edit Contact View -->
                <div id="addView" class="view">
                    <div class="form-container">
                        <h2 id="formTitle">Yeni Ki≈üi Ekle</h2>
                        <form id="contactForm">
                            <input type="hidden" id="editContactId">

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="contactName">ƒ∞sim *</label>
                                    <input type="text" id="contactName" placeholder="Adƒ±" required>
                                </div>
                                <div class="form-group">
                                    <label for="contactSurname">Soyisim</label>
                                    <input type="text" id="contactSurname" placeholder="Soyadƒ±">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="contactEmail">E-posta</label>
                                    <input type="email" id="contactEmail" placeholder="ornek@email.com">
                                </div>
                                <div class="form-group">
                                    <label for="contactPhone">Telefon</label>
                                    <input type="tel" id="contactPhone" placeholder="+90 555 123 4567">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="contactPhone2">ƒ∞kinci Telefon</label>
                                <input type="tel" id="contactPhone2" placeholder="+90 555 987 6543">
                            </div>

                            <div class="form-group">
                                <label for="contactAddress">Adres</label>
                                <textarea id="contactAddress" placeholder="Tam adres (geocoding i√ßin)"
                                    rows="2"></textarea>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="contactCity">≈ûehir</label>
                                    <input type="text" id="contactCity" placeholder="≈ûehir">
                                </div>
                                <div class="form-group">
                                    <label for="contactCountry">√úlke</label>
                                    <input type="text" id="contactCountry" placeholder="√úlke" value="T√ºrkiye">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="contactTags">Etiketler</label>
                                <input type="text" id="contactTags" placeholder="aile, i≈ü, arkada≈ü (virg√ºlle ayƒ±rƒ±n)">
                            </div>

                            <div class="form-group">
                                <label for="contactNotes">Notlar</label>
                                <textarea id="contactNotes" placeholder="Ek notlar..." rows="3"></textarea>
                            </div>

                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="contactFavorite">
                                    <span>Favori olarak i≈üaretle</span>
                                </label>
                            </div>

                            <div class="form-actions">
                                <button type="button" id="cancelEdit" class="btn btn-secondary"
                                    style="display: none;">ƒ∞ptal</button>
                                <button type="submit" class="btn btn-primary">
                                    <span id="submitBtnText">Ki≈üi Ekle</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Contact Detail Modal -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalContactName">Ki≈üi Detayƒ±</h2>
                <button class="modal-close" id="closeModal">√ó</button>
            </div>
            <div class="modal-body" id="modalContactDetails">
                <!-- Dynamically filled -->
            </div>
            <div class="modal-footer">
                <button id="modalEnrichBtn" class="btn btn-enrich" title="Veri Zenginle≈ütirme">
                    <span class="icon">üîç</span> Zenginle≈ütir
                </button>
                <button id="modalEditBtn" class="btn btn-secondary">D√ºzenle</button>
                <button id="modalDeleteBtn" class="btn btn-danger">Sil</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h2>Silme Onayƒ±</h2>
                <button class="modal-close" id="closeDeleteModal">√ó</button>
            </div>
            <div class="modal-body">
                <p>Bu ki≈üiyi silmek istediƒüinize emin misiniz?</p>
                <p class="text-muted" id="deleteContactName"></p>
            </div>
            <div class="modal-footer">
                <button id="cancelDelete" class="btn btn-secondary">ƒ∞ptal</button>
                <button id="confirmDelete" class="btn btn-danger">Sil</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <!-- Leaflet Plugins for Phase 4 -->
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <!-- D3.js for Phase 5 -->
    <script src="https://unpkg.com/d3@7.8.5/dist/d3.min.js"></script>
    <script src="script.js"></script>
</body>

</html>